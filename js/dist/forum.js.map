{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@nearata/flarum-ext-directory-listing/webpack/bootstrap","webpack://@nearata/flarum-ext-directory-listing/webpack/runtime/compat get default export","webpack://@nearata/flarum-ext-directory-listing/webpack/runtime/define property getters","webpack://@nearata/flarum-ext-directory-listing/webpack/runtime/hasOwnProperty shorthand","webpack://@nearata/flarum-ext-directory-listing/webpack/runtime/make namespace object","webpack://@nearata/flarum-ext-directory-listing/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@nearata/flarum-ext-directory-listing/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@nearata/flarum-ext-directory-listing/external root \"flarum.core.compat['common/resolvers/DefaultResolver']\"","webpack://@nearata/flarum-ext-directory-listing/./src/forum/DirectoryListingResolver.ts","webpack://@nearata/flarum-ext-directory-listing/external root \"flarum.core.compat['forum/app']\"","webpack://@nearata/flarum-ext-directory-listing/./src/forum/states/DirectoryTreeState.ts","webpack://@nearata/flarum-ext-directory-listing/external root \"flarum.core.compat['common/Component']\"","webpack://@nearata/flarum-ext-directory-listing/external root \"flarum.core.compat['common/components/Link']\"","webpack://@nearata/flarum-ext-directory-listing/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@nearata/flarum-ext-directory-listing/./src/forum/components/DirectoryTreeBackItem.tsx","webpack://@nearata/flarum-ext-directory-listing/./src/forum/components/DirectoryTreeBreadcrumb.tsx","webpack://@nearata/flarum-ext-directory-listing/external root \"flarum.core.compat['common/utils/humanTime']\"","webpack://@nearata/flarum-ext-directory-listing/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@nearata/flarum-ext-directory-listing/./node_modules/pretty-bytes/index.js","webpack://@nearata/flarum-ext-directory-listing/./src/forum/components/DirectoryTreeItem.tsx","webpack://@nearata/flarum-ext-directory-listing/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@nearata/flarum-ext-directory-listing/external root \"flarum.core.compat['common/components/Placeholder']\"","webpack://@nearata/flarum-ext-directory-listing/./src/forum/components/DirectoryTree.tsx","webpack://@nearata/flarum-ext-directory-listing/external root \"flarum.core.compat['common/components/Page']\"","webpack://@nearata/flarum-ext-directory-listing/external root \"flarum.core.compat['common/helpers/listItems']\"","webpack://@nearata/flarum-ext-directory-listing/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@nearata/flarum-ext-directory-listing/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@nearata/flarum-ext-directory-listing/./src/forum/components/DirectoryListingPage.tsx","webpack://@nearata/flarum-ext-directory-listing/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@nearata/flarum-ext-directory-listing/external root \"flarum.core.compat['common/extend']\"","webpack://@nearata/flarum-ext-directory-listing/./src/forum/index.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/resolvers/DefaultResolver'];","import DefaultResolver from \"flarum/common/resolvers/DefaultResolver\";\n\nexport default class DirectoryListingResolver extends DefaultResolver {\n  makeKey() {\n    let path = m.route.param(\"path\");\n\n    if (!path) {\n      path = \"\";\n    }\n\n    return path;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","import app from \"flarum/forum/app\";\n\nexport type Data = {\n  type: string;\n  path: string;\n  timestamp: number;\n  dirname: string;\n  basename: string;\n  filename: string;\n  size: number | undefined;\n  extension: string | undefined;\n};\n\nexport default class DirectoryTreeState {\n  loading: boolean;\n  data: Array<Data>;\n\n  constructor() {\n    this.loading = true;\n    this.data = [];\n  }\n\n  isLoading() {\n    return this.loading;\n  }\n\n  loadData() {\n    let path = m.route.param(\"path\");\n\n    if (!path) {\n      path = \"\";\n    }\n\n    app\n      .request({\n        method: \"POST\",\n        url: app.forum.attribute(\"apiUrl\") + \"/nearata/directoryListing\",\n        body: { path },\n      })\n      .then((res: any) => {\n        this.data = res.data;\n\n        this.loading = false;\n\n        m.redraw();\n      })\n      .catch(() => {\n        this.loading = false;\n\n        m.redraw();\n      });\n  }\n\n  getData() {\n    return this.data;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","import Component from \"flarum/common/Component\";\nimport Link from \"flarum/common/components/Link\";\nimport icon from \"flarum/common/helpers/icon\";\nimport app from \"flarum/forum/app\";\nimport type Mithril from \"mithril\";\n\nexport default class DirectoryTreeBackItem extends Component {\n  oninit(vnode: Mithril.Vnode<this>): void {\n    super.oninit(vnode);\n  }\n\n  oncreate(vnode: Mithril.VnodeDOM<this>): void {\n    super.oncreate(vnode);\n  }\n\n  view() {\n    const { path }: { path: string } = m.route.param();\n\n    if (!path) {\n      return;\n    }\n\n    const splitPath = path.split(\"/\");\n    splitPath.pop();\n\n    const href = app.route(\"nearataDirectoryListing\", {\n      path: splitPath.join(),\n    });\n\n    return (\n      <Link class=\"DirectoryTreeBackItem\" href={href}>\n        <div class=\"icon\">{icon(\"fas fa-level-up-alt\")}</div>\n        <div>..</div>\n      </Link>\n    );\n  }\n}\n","import Component from \"flarum/common/Component\";\nimport Link from \"flarum/common/components/Link\";\nimport app from \"flarum/forum/app\";\nimport type Mithril from \"mithril\";\n\nexport default class DirectoryTreeBreadcrumb extends Component {\n  oninit(vnode: Mithril.Vnode<this>): void {\n    super.oninit(vnode);\n  }\n\n  oncreate(vnode: Mithril.VnodeDOM<this>): void {\n    super.oncreate(vnode);\n  }\n\n  view() {\n    const path: string = m.route.param(\"path\");\n\n    let currentPath = \"\";\n\n    return (\n      <div class=\"DirectoryTreeBreadcrumb\">\n        <Link class=\"item\" href={app.route(\"nearataDirectoryListing\")}>\n          Home\n        </Link>\n        {path &&\n          path.split(\"/\").map((val, index, array) => {\n            currentPath += `${val}`;\n\n            if (index !== array.length - 1) {\n              currentPath += \"/\";\n            }\n\n            return (\n              <Link\n                class=\"item\"\n                href={app.route(\"nearataDirectoryListing\", {\n                  path: currentPath,\n                })}\n              >\n                {val}\n              </Link>\n            );\n          })}\n      </div>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/humanTime'];","export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","const BYTE_UNITS = [\n\t'B',\n\t'kB',\n\t'MB',\n\t'GB',\n\t'TB',\n\t'PB',\n\t'EB',\n\t'ZB',\n\t'YB',\n];\n\nconst BIBYTE_UNITS = [\n\t'B',\n\t'kiB',\n\t'MiB',\n\t'GiB',\n\t'TiB',\n\t'PiB',\n\t'EiB',\n\t'ZiB',\n\t'YiB',\n];\n\nconst BIT_UNITS = [\n\t'b',\n\t'kbit',\n\t'Mbit',\n\t'Gbit',\n\t'Tbit',\n\t'Pbit',\n\t'Ebit',\n\t'Zbit',\n\t'Ybit',\n];\n\nconst BIBIT_UNITS = [\n\t'b',\n\t'kibit',\n\t'Mibit',\n\t'Gibit',\n\t'Tibit',\n\t'Pibit',\n\t'Eibit',\n\t'Zibit',\n\t'Yibit',\n];\n\n/*\nFormats the given number using `Number#toLocaleString`.\n- If locale is a string, the value is expected to be a locale-key (for example: `de`).\n- If locale is true, the system default locale is used for translation.\n- If no value for locale is specified, the number is returned unmodified.\n*/\nconst toLocaleString = (number, locale, options) => {\n\tlet result = number;\n\tif (typeof locale === 'string' || Array.isArray(locale)) {\n\t\tresult = number.toLocaleString(locale, options);\n\t} else if (locale === true || options !== undefined) {\n\t\tresult = number.toLocaleString(undefined, options);\n\t}\n\n\treturn result;\n};\n\nexport default function prettyBytes(number, options) {\n\tif (!Number.isFinite(number)) {\n\t\tthrow new TypeError(`Expected a finite number, got ${typeof number}: ${number}`);\n\t}\n\n\toptions = {\n\t\tbits: false,\n\t\tbinary: false,\n\t\tspace: true,\n\t\t...options,\n\t};\n\n\tconst UNITS = options.bits\n\t\t? (options.binary ? BIBIT_UNITS : BIT_UNITS)\n\t\t: (options.binary ? BIBYTE_UNITS : BYTE_UNITS);\n\n\tconst separator = options.space ? ' ' : '';\n\n\tif (options.signed && number === 0) {\n\t\treturn ` 0${separator}${UNITS[0]}`;\n\t}\n\n\tconst isNegative = number < 0;\n\tconst prefix = isNegative ? '-' : (options.signed ? '+' : '');\n\n\tif (isNegative) {\n\t\tnumber = -number;\n\t}\n\n\tlet localeOptions;\n\n\tif (options.minimumFractionDigits !== undefined) {\n\t\tlocaleOptions = {minimumFractionDigits: options.minimumFractionDigits};\n\t}\n\n\tif (options.maximumFractionDigits !== undefined) {\n\t\tlocaleOptions = {maximumFractionDigits: options.maximumFractionDigits, ...localeOptions};\n\t}\n\n\tif (number < 1) {\n\t\tconst numberString = toLocaleString(number, options.locale, localeOptions);\n\t\treturn prefix + numberString + separator + UNITS[0];\n\t}\n\n\tconst exponent = Math.min(Math.floor(options.binary ? Math.log(number) / Math.log(1024) : Math.log10(number) / 3), UNITS.length - 1);\n\tnumber /= (options.binary ? 1024 : 1000) ** exponent;\n\n\tif (!localeOptions) {\n\t\tnumber = number.toPrecision(3);\n\t}\n\n\tconst numberString = toLocaleString(Number(number), options.locale, localeOptions);\n\n\tconst unit = UNITS[exponent];\n\n\treturn prefix + numberString + separator + unit;\n}\n","import { Data } from \"../states/DirectoryTreeState\";\nimport Component from \"flarum/common/Component\";\nimport Link from \"flarum/common/components/Link\";\nimport icon from \"flarum/common/helpers/icon\";\nimport humanTime from \"flarum/common/utils/humanTime\";\nimport app from \"flarum/forum/app\";\nimport type Mithril from \"mithril\";\nimport prettyBytes from \"pretty-bytes\";\n\ntype Attrs = {\n  data: Data;\n};\n\nexport default class DirectoryTreeItem extends Component<Attrs> {\n  data!: Data;\n  external!: boolean;\n  externalHref!: any;\n\n  oninit(vnode: Mithril.Vnode<this>): void {\n    super.oninit(vnode);\n\n    this.data = this.attrs.data;\n\n    this.external = this.data.type !== \"dir\";\n    this.externalHref =\n      this.external &&\n      location.origin + \"/assets/nearataDirectoryListing/\" + this.data.path;\n  }\n\n  oncreate(vnode: Mithril.VnodeDOM<this>): void {\n    super.oncreate(vnode);\n  }\n\n  view() {\n    return (\n      <Link\n        class=\"DirectoryTreeItem\"\n        external={this.external}\n        href={\n          this.external\n            ? this.externalHref\n            : app.route(\"nearataDirectoryListing\", { path: this.data.path })\n        }\n      >\n        <div class=\"icon\">\n          {this.external ? icon(\"fas fa-file\") : icon(\"fas fa-folder\")}\n        </div>\n        <div class=\"fileName\">\n          {this.data.filename}\n          {this.data.extension && \".\" + this.data.extension}\n        </div>\n        <div class=\"size\">\n          {this.data.size ? prettyBytes(this.data.size) : \"-\"}\n        </div>\n        <div class=\"date\">\n          {humanTime(window.dayjs.unix(this.data.timestamp).toISOString())}\n        </div>\n      </Link>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Placeholder'];","import DirectoryTreeState from \"../states/DirectoryTreeState\";\nimport DirectoryTreeBackItem from \"./DirectoryTreeBackItem\";\nimport DirectoryTreeBreadcrumb from \"./DirectoryTreeBreadcrumb\";\nimport DirectoryTreeItem from \"./DirectoryTreeItem\";\nimport Component from \"flarum/common/Component\";\nimport LoadingIndicator from \"flarum/common/components/LoadingIndicator\";\nimport Placeholder from \"flarum/common/components/Placeholder\";\nimport app from \"flarum/forum/app\";\nimport type Mithril from \"mithril\";\n\ntype Attrs = {\n  state: DirectoryTreeState;\n};\n\nexport default class DirectoryTree extends Component<Attrs> {\n  directoryState!: DirectoryTreeState;\n\n  oninit(vnode: Mithril.Vnode<this>): void {\n    super.oninit(vnode);\n\n    this.directoryState = this.attrs.state;\n    this.directoryState.loadData();\n  }\n\n  oncreate(vnode: Mithril.VnodeDOM<this>): void {\n    super.oncreate(vnode);\n  }\n\n  view() {\n    if (this.directoryState.isLoading()) {\n      return <LoadingIndicator />;\n    }\n\n    const placeholderText = app.translator.trans(\n      \"nearata-directory-listing.forum.placeholder_empty_folder_text\"\n    );\n\n    return (\n      <div class=\"DirectoryTreeList\">\n        <DirectoryTreeBreadcrumb />\n        <DirectoryTreeBackItem />\n        {!this.directoryState.getData().length && (\n          <Placeholder text={placeholderText} />\n        )}\n        {this.directoryState.getData().map(function (val) {\n          return <DirectoryTreeItem data={val} />;\n        })}\n      </div>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/listItems'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","import DirectoryTreeState from \"../states/DirectoryTreeState\";\nimport DirectoryTree from \"./DirectoryTree\";\nimport Page from \"flarum/common/components/Page\";\nimport listItems from \"flarum/common/helpers/listItems\";\nimport extractText from \"flarum/common/utils/extractText\";\nimport app from \"flarum/forum/app\";\nimport IndexPage from \"flarum/forum/components/IndexPage\";\nimport type Mithril from \"mithril\";\n\nexport default class DirectoryListingPage extends Page {\n  directoryState!: DirectoryTreeState;\n\n  oninit(vnode: Mithril.Vnode<this>): void {\n    super.oninit(vnode);\n\n    this.directoryState = new DirectoryTreeState();\n  }\n\n  oncreate(vnode: Mithril.VnodeDOM<this>): void {\n    super.oncreate(vnode);\n\n    app.setTitle(\n      extractText(\n        app.translator.trans(\"nearata-directory-listing.forum.page_title\")\n      )\n    );\n    app.setTitleCount(0);\n  }\n\n  view() {\n    return (\n      <div className=\"NearataDirectoryListing\">\n        {IndexPage.prototype.hero()}\n        <div className=\"container\">\n          <div class=\"sideNavContainer\">\n            <nav class=\"IndexPage-nav sideNav\">\n              <ul>{listItems(IndexPage.prototype.sidebarItems().toArray())}</ul>\n            </nav>\n            <div class=\"IndexPage-results sideNavOffset\">\n              <DirectoryTree state={this.directoryState} />\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","import DirectoryListingResolver from \"./DirectoryListingResolver\";\nimport DirectoryListingPage from \"./components/DirectoryListingPage\";\nimport LinkButton from \"flarum/common/components/LinkButton\";\nimport { extend } from \"flarum/common/extend\";\nimport app from \"flarum/forum/app\";\nimport IndexPage from \"flarum/forum/components/IndexPage\";\n\napp.initializers.add(\"nearata-directory-listing\", () => {\n  app.routes.nearataDirectoryListing = {\n    path: \"/directoryListing\",\n    component: DirectoryListingPage,\n    resolverClass: DirectoryListingResolver,\n  };\n\n  extend(IndexPage.prototype, \"navItems\", function (items) {\n    items.add(\n      \"nearataDirectoryListing\",\n      <LinkButton\n        icon=\"fas fa-folder\"\n        href={app.route(\"nearataDirectoryListing\")}\n      >\n        {app.translator.trans(\"nearata-directory-listing.forum.page_title\")}\n      </LinkButton>,\n      -1\n    );\n  });\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","flarum","core","compat","DirectoryListingResolver","makeKey","path","m","route","param","DefaultResolver","DirectoryTreeState","loading","data","this","isLoading","loadData","app","method","url","body","then","res","redraw","getData","DirectoryTreeBackItem","oninit","vnode","oncreate","view","splitPath","split","pop","href","join","class","icon","Component","DirectoryTreeBreadcrumb","currentPath","map","val","index","array","length","_extends","assign","target","i","arguments","source","apply","BYTE_UNITS","BIBYTE_UNITS","BIT_UNITS","BIBIT_UNITS","toLocaleString","number","locale","options","result","Array","isArray","undefined","DirectoryTreeItem","external","externalHref","attrs","type","location","origin","filename","extension","size","Number","isFinite","TypeError","UNITS","bits","binary","space","separator","signed","localeOptions","isNegative","prefix","minimumFractionDigits","maximumFractionDigits","exponent","Math","min","floor","log","log10","toPrecision","prettyBytes","humanTime","window","dayjs","unix","timestamp","toISOString","DirectoryTree","directoryState","state","placeholderText","text","DirectoryListingPage","extractText","className","IndexPage","listItems","toArray","Page","component","resolverClass","extend","items","add"],"sourceRoot":""}