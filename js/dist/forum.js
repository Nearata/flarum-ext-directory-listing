(()=>{var t={n:r=>{var i=r&&r.__esModule?()=>r.default:()=>r;return t.d(i,{a:i}),i},d:(r,i)=>{for(var a in i)t.o(i,a)&&!t.o(r,a)&&Object.defineProperty(r,a,{enumerable:!0,get:i[a]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},r={};(()=>{"use strict";function i(t,r){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},i(t,r)}function a(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,i(t,r)}t.r(r);const e=flarum.core.compat["forum/app"];var o=t.n(e),n=function(){function t(){this.loading=void 0,this.data=void 0,this.loading=!0,this.data=[]}var r=t.prototype;return r.isLoading=function(){return this.loading},r.loadData=function(){var t=this,r=m.route.param().path;r||(r=""),o().request({method:"POST",url:o().forum.attribute("apiUrl")+"/nearata/directoryListing",body:{path:r}}).then((function(r){t.data=r.data,t.loading=!1,m.redraw()})).catch((function(){t.loading=!1,m.redraw()}))},r.getData=function(){return this.data},t}();const c=flarum.core.compat["common/Component"];var s=t.n(c);const l=flarum.core.compat["common/components/Link"];var u=t.n(l);const p=flarum.core.compat["common/helpers/icon"];var d=t.n(p),f=function(t){function r(){return t.apply(this,arguments)||this}a(r,t);var i=r.prototype;return i.oninit=function(r){t.prototype.oninit.call(this,r)},i.oncreate=function(r){t.prototype.oncreate.call(this,r)},i.view=function(){var t=m.route.param().path;if(t){var r=t.split("/");r.pop();var i=o().route("nearataDirectoryListing",{path:r.join()});return m(u(),{class:"DirectoryTreeBackItem",href:i},m("div",{class:"icon"},d()("fas fa-level-up-alt")),m("div",null,".."))}},r}(s());const h=flarum.core.compat["common/utils/humanTime"];var y=t.n(h);function v(){return v=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var i=arguments[r];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t},v.apply(this,arguments)}var g=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],b=["B","kiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],x=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],D=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],B=function(t,r,i){var a=t;return"string"==typeof r||Array.isArray(r)?a=t.toLocaleString(r,i):!0!==r&&void 0===i||(a=t.toLocaleString(void 0,i)),a},S=function(t){function r(){for(var r,i=arguments.length,a=new Array(i),e=0;e<i;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).data=void 0,r.external=void 0,r.externalHref=void 0,r}a(r,t);var i=r.prototype;return i.oninit=function(r){t.prototype.oninit.call(this,r),this.data=this.attrs.data,this.external="dir"!==this.data.type,this.externalHref=this.external&&location.origin+"/assets/nearataDirectoryListing/"+this.data.path},i.oncreate=function(r){t.prototype.oncreate.call(this,r)},i.view=function(){return m(u(),{class:"DirectoryTreeItem",external:this.external,href:this.external?this.externalHref:o().route("nearataDirectoryListing",{path:this.data.path})},m("div",{class:"icon"},this.external?d()("fas fa-file"):d()("fas fa-folder")),m("div",{class:"fileName"},this.data.filename,"extension"in this.data&&"."+this.data.extension),m("div",{class:"size"},this.data.size?function(t,r){if(!Number.isFinite(t))throw new TypeError("Expected a finite number, got "+typeof t+": "+t);var i=(r=v({bits:!1,binary:!1,space:!0},r)).bits?r.binary?D:x:r.binary?b:g,a=r.space?" ":"";if(r.signed&&0===t)return" 0"+a+i[0];var e,o=t<0,n=o?"-":r.signed?"+":"";if(o&&(t=-t),void 0!==r.minimumFractionDigits&&(e={minimumFractionDigits:r.minimumFractionDigits}),void 0!==r.maximumFractionDigits&&(e=v({maximumFractionDigits:r.maximumFractionDigits},e)),t<1)return n+B(t,r.locale,e)+a+i[0];var c=Math.min(Math.floor(r.binary?Math.log(t)/Math.log(1024):Math.log10(t)/3),i.length-1);return t/=Math.pow(r.binary?1024:1e3,c),e||(t=t.toPrecision(3)),n+B(Number(t),r.locale,e)+a+i[c]}(this.data.size):"-"),m("div",{class:"date"},y()(window.dayjs.unix(this.data.timestamp).toISOString())))},r}(s());const P=flarum.core.compat["common/components/LoadingIndicator"];var w=t.n(P);const L=flarum.core.compat["common/components/Placeholder"];var O=t.n(L),T=function(t){function r(){for(var r,i=arguments.length,a=new Array(i),e=0;e<i;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).directoryState=void 0,r}a(r,t);var i=r.prototype;return i.oninit=function(r){t.prototype.oninit.call(this,r),this.directoryState=this.attrs.state,this.directoryState.loadData()},i.oncreate=function(r){t.prototype.oncreate.call(this,r)},i.view=function(){if(this.directoryState.isLoading())return m(w(),null);var t=o().translator.trans("nearata-directory-listing.forum.placeholder_empty_folder_text");return m("div",{class:"DirectoryTreeList"},m(f,null),!this.directoryState.getData().length&&m(O(),{text:t}),this.directoryState.getData().map((function(t){return m(S,{data:t})})))},r}(s());const M=flarum.core.compat["common/components/Page"];var _=t.n(M);const j=flarum.core.compat["common/helpers/listItems"];var I=t.n(j);const N=flarum.core.compat["common/utils/extractText"];var k=t.n(N);const F=flarum.core.compat["forum/components/IndexPage"];var A=t.n(F),E=function(t){function r(){for(var r,i=arguments.length,a=new Array(i),e=0;e<i;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).directoryState=void 0,r}a(r,t);var i=r.prototype;return i.oninit=function(r){t.prototype.oninit.call(this,r),this.directoryState=new n},i.oncreate=function(r){t.prototype.oncreate.call(this,r),o().setTitle(k()(o().translator.trans("nearata-directory-listing.forum.page_title"))),o().setTitleCount(0)},i.view=function(){return m("div",{className:"NearataDirectoryListing"},A().prototype.hero(),m("div",{className:"container"},m("div",{class:"sideNavContainer"},m("nav",{class:"IndexPage-nav sideNav"},m("ul",null,I()(A().prototype.sidebarItems().toArray()))),m("div",{class:"IndexPage-results sideNavOffset"},m(T,{state:this.directoryState})))))},r}(_());const z=flarum.core.compat["common/components/LinkButton"];var G=t.n(z);const Y=flarum.core.compat["common/extend"];o().initializers.add("nearata-directory-listing",(function(){o().routes.nearataDirectoryListing={path:"/directoryListing",component:E},(0,Y.extend)(A().prototype,"navItems",(function(t){t.add("nearataDirectoryListing",m(G(),{icon:"fas fa-folder",href:o().route("nearataDirectoryListing")},o().translator.trans("nearata-directory-listing.forum.page_title")),-1)}))}))})(),module.exports=r})();
//# sourceMappingURL=forum.js.map