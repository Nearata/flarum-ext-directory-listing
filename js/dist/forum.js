(()=>{var t={n:i=>{var r=i&&i.__esModule?()=>i.default:()=>i;return t.d(r,{a:r}),r},d:(i,r)=>{for(var a in r)t.o(r,a)&&!t.o(i,a)&&Object.defineProperty(i,a,{enumerable:!0,get:r[a]})},o:(t,i)=>Object.prototype.hasOwnProperty.call(t,i),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},i={};(()=>{"use strict";function r(t,i){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},r(t,i)}function a(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,r(t,i)}t.r(i);const e=flarum.core.compat["forum/app"];var o=t.n(e),n=function(){function t(){this.loading=void 0,this.data=void 0,this.loading=!0,this.data=[]}var i=t.prototype;return i.isLoading=function(){return this.loading},i.loadData=function(){var t=this,i=m.route.param().path;i||(i=""),o().request({method:"POST",url:o().forum.attribute("apiUrl")+"/nearata/directoryListing",body:{path:i}}).then((function(i){t.data=i.data,t.loading=!1,m.redraw()})).catch((function(){t.loading=!1,m.redraw()}))},i.getData=function(){return this.data},t}();const c=flarum.core.compat["common/Component"];var s=t.n(c);const l=flarum.core.compat["common/components/Link"];var u=t.n(l);const d=flarum.core.compat["common/helpers/icon"];var p=t.n(d);const f=flarum.core.compat["common/utils/humanTime"];var h=t.n(f);function y(){return y=Object.assign?Object.assign.bind():function(t){for(var i=1;i<arguments.length;i++){var r=arguments[i];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},y.apply(this,arguments)}var v=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],g=["B","kiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],b=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],x=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],B=function(t,i,r){var a=t;return"string"==typeof i||Array.isArray(i)?a=t.toLocaleString(i,r):!0!==i&&void 0===r||(a=t.toLocaleString(void 0,r)),a},D=function(t){function i(){for(var i,r=arguments.length,a=new Array(r),e=0;e<r;e++)a[e]=arguments[e];return(i=t.call.apply(t,[this].concat(a))||this).data=void 0,i.external=void 0,i.externalHref=void 0,i}a(i,t);var r=i.prototype;return r.oninit=function(i){t.prototype.oninit.call(this,i),this.data=this.attrs.data,this.external="dir"!==this.data.type,this.externalHref=this.external&&location.origin+"/assets/nearataDirectoryListing/"+this.data.path},r.oncreate=function(i){t.prototype.oncreate.call(this,i)},r.view=function(){return m(u(),{class:"DirectoryTreeItem",external:this.external,href:this.external?this.externalHref:o().route("nearataDirectoryListing",{path:this.data.path})},m("div",{class:"icon"},this.external?p()("fas fa-file"):p()("fas fa-folder")),m("div",{class:"fileName"},this.data.filename),m("div",{class:"size"},this.data.size?function(t,i){if(!Number.isFinite(t))throw new TypeError("Expected a finite number, got "+typeof t+": "+t);var r=(i=y({bits:!1,binary:!1,space:!0},i)).bits?i.binary?x:b:i.binary?g:v,a=i.space?" ":"";if(i.signed&&0===t)return" 0"+a+r[0];var e,o=t<0,n=o?"-":i.signed?"+":"";if(o&&(t=-t),void 0!==i.minimumFractionDigits&&(e={minimumFractionDigits:i.minimumFractionDigits}),void 0!==i.maximumFractionDigits&&(e=y({maximumFractionDigits:i.maximumFractionDigits},e)),t<1)return n+B(t,i.locale,e)+a+r[0];var c=Math.min(Math.floor(i.binary?Math.log(t)/Math.log(1024):Math.log10(t)/3),r.length-1);return t/=Math.pow(i.binary?1024:1e3,c),e||(t=t.toPrecision(3)),n+B(Number(t),i.locale,e)+a+r[c]}(this.data.size):"-"),m("div",{class:"date"},h()(window.dayjs.unix(this.data.timestamp).toISOString())))},i}(s());const S=flarum.core.compat["common/components/LoadingIndicator"];var O=t.n(S),P=function(t){function i(){for(var i,r=arguments.length,a=new Array(r),e=0;e<r;e++)a[e]=arguments[e];return(i=t.call.apply(t,[this].concat(a))||this).directoryState=void 0,i}a(i,t);var r=i.prototype;return r.oninit=function(i){t.prototype.oninit.call(this,i),this.directoryState=this.attrs.state,this.directoryState.loadData()},r.oncreate=function(i){t.prototype.oncreate.call(this,i)},r.view=function(){return this.directoryState.isLoading()?m(O(),null):m("div",{class:"DirectoryTreeList"},this.directoryState.getData().map((function(t){return m(D,{data:t})})))},i}(s());const w=flarum.core.compat["common/components/Page"];var L=t.n(w);const T=flarum.core.compat["common/helpers/listItems"];var M=t.n(T);const j=flarum.core.compat["common/utils/extractText"];var _=t.n(j);const I=flarum.core.compat["forum/components/IndexPage"];var N=t.n(I),F=function(t){function i(){for(var i,r=arguments.length,a=new Array(r),e=0;e<r;e++)a[e]=arguments[e];return(i=t.call.apply(t,[this].concat(a))||this).directoryState=void 0,i}a(i,t);var r=i.prototype;return r.oninit=function(i){t.prototype.oninit.call(this,i),this.directoryState=new n},r.oncreate=function(i){t.prototype.oncreate.call(this,i),o().setTitle(_()(o().translator.trans("nearata-directory-listing.forum.page_title"))),o().setTitleCount(0)},r.view=function(){return m("div",{className:"NearataDirectoryListing"},N().prototype.hero(),m("div",{className:"container"},m("div",{class:"sideNavContainer"},m("nav",{class:"IndexPage-nav sideNav"},m("ul",null,M()(N().prototype.sidebarItems().toArray()))),m("div",{class:"IndexPage-results sideNavOffset"},m(P,{state:this.directoryState})))))},i}(L());const k=flarum.core.compat["common/components/LinkButton"];var A=t.n(k);const E=flarum.core.compat["common/extend"];o().initializers.add("nearata-directory-listing",(function(){o().routes.nearataDirectoryListing={path:"/directoryListing",component:F},(0,E.extend)(N().prototype,"navItems",(function(t){t.add("nearataDirectoryListing",m(A(),{icon:"fas fa-folder",href:o().route("nearataDirectoryListing")},o().translator.trans("nearata-directory-listing.forum.page_title")),-1)}))}))})(),module.exports=i})();
//# sourceMappingURL=forum.js.map